!function(t){t.address=function(){var e,r,n,a=function(e){return e=t.extend(t.Event(e),function(){for(var e={},r=t.address.parameterNames(),n=0,a=r.length;n<a;n++)e[r[n]]=t.address.parameter(r[n]);return{value:t.address.value(),path:t.address.path(),pathNames:t.address.pathNames(),parameterNames:r,parameters:e,queryString:t.address.queryString()}}.call(t.address)),t(t.address).trigger(e),e},i=function(t){return Array.prototype.slice.call(t)},s=function(){return t().bind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address},o=function(){return O.pushState&&R.state!==e},c=function(){return("/"+L.pathname.replace(new RegExp(R.state),"")+L.search+(u()?"#"+u():"")).replace(M,"/")},u=function(){var t=L.href.indexOf("#");return-1!=t?L.href.substr(t+1):""},d=function(){return o()?c():u()},l=function(t){return t=t.toString(),(R.strict&&"/"!=t.substr(0,1)?"/":"")+t},p=function(t,e){return parseInt(t.css(e),10)},h=function(){if(!D){var t=d();decodeURI(H)!=decodeURI(t)&&(q&&A<7?L.reload():(q&&!_&&R.history&&C(v,50),H=t,f(U)))}},f=function(t){return C(g,10),a(k).isDefaultPrevented()||a(t?E:S).isDefaultPrevented()},g=function(){if("null"!==R.tracker&&R.tracker!==w){var r=t.isFunction(R.tracker)?R.tracker:N[R.tracker],n=(L.pathname+L.search+(t.address&&!o()?t.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");t.isFunction(r)?r(n):t.isFunction(N.urchinTracker)?N.urchinTracker(n):N.pageTracker!==e&&t.isFunction(N.pageTracker._trackPageview)?N.pageTracker._trackPageview(n):N._gaq!==e&&t.isFunction(N._gaq.push)&&N._gaq.push(["_trackPageview",decodeURI(n)])}},v=function(){var t="javascript:"+U+";document.open();document.writeln('<html><head><title>"+$.title.replace(/\'/g,"\\'")+"</title><script>var "+b+' = "'+encodeURIComponent(d()).replace(/\'/g,"\\'")+($.domain!=L.hostname?'";document.domain="'+$.domain:"")+"\";<\/script></head></html>');document.close();";A<7?W.src=t:W.contentWindow.location.replace(t)},m=function(){if(z&&-1!=B){var t,e,r=z.substr(B+1).split("&");for(t=0;t<r.length;t++)e=r[t].split("="),/^(autoUpdate|history|strict|wrap)$/.test(e[0])&&(R[e[0]]=isNaN(e[1])?/^(true|yes)$/i.test(e[1]):0!==parseInt(e[1],10)),/^(state|tracker)$/.test(e[0])&&(R[e[0]]=e[1]);z=w}H=d()},y=function(){if(!K){if(K=I,m(),t('a[rel*="address:"]').address(),R.wrap){var r=t("body");t("body > *").wrapAll('<div style="padding:'+(p(r,"marginTop")+p(r,"paddingTop"))+"px "+(p(r,"marginRight")+p(r,"paddingRight"))+"px "+(p(r,"marginBottom")+p(r,"paddingBottom"))+"px "+(p(r,"marginLeft")+p(r,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+b+'" style="height:100%;overflow:auto;position:relative;'+(j&&!window.statusbar.visible?"resize:both;":"")+'" />'),t("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"}),j&&t('<style type="text/css" />').appendTo("head").text("#"+b+"::-webkit-resizer { background-color: #fff; }")}q&&!_&&(r=$.getElementsByTagName("frameset")[0],(W=$.createElement((r?"":"i")+"frame")).src="javascript:"+U,r?(r.insertAdjacentElement("beforeEnd",W),r[r.cols?"cols":"rows"]+=",0",W.noResize=I,W.frameBorder=W.frameSpacing=0):(W.style.display="none",W.style.width=W.style.height=0,W.tabIndex=-1,$.body.insertAdjacentElement("afterBegin",W)),C(function(){t(W).bind("load",function(){var t=W.contentWindow;(H=t[b]!==e?t[b]:"")!=d()&&(f(U),L.hash=H)}),W.contentWindow[b]===e&&v()},50)),C(function(){a("init"),f(U)},1),o()||(q&&A>7||!q&&_?N.addEventListener?N.addEventListener(x,h,U):N.attachEvent&&N.attachEvent("on"+x,h):F(h,50)),"state"in window.history&&t(window).trigger("popstate")}},w=null,b="jQueryAddress",x="hashchange",k="change",E="internalChange",S="externalChange",I=!0,U=!1,R={autoUpdate:I,history:I,strict:I,wrap:U},T=(r={},(n=function(t){return t=t.toLowerCase(),{browser:(t=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[])[1]||"",version:t[2]||"0"}}(navigator.userAgent)).browser&&(r[n.browser]=!0,r.version=n.version),r.chrome?r.webkit=!0:r.webkit&&(r.safari=!0),r),A=parseFloat(T.version),j=T.webkit||T.safari,q=!t.support.opacity,N=function(){try{return top.document!==e&&top.document.title!==e?top:window}catch(t){return window}}(),$=N.document,O=N.history,L=N.location,F=setInterval,C=setTimeout,M=/\/{2,9}/g;T=navigator.userAgent;var W,_="on"+x in N,z=t("script:last").attr("src"),B=z?z.indexOf("?"):-1,P=$.title,D=U,K=U,Q=I,G=U,H=d();if(q){A=parseFloat(T.substr(T.indexOf("MSIE")+4)),$.documentMode&&$.documentMode!=A&&(A=8!=$.documentMode?7:8);var J=$.onpropertychange;$.onpropertychange=function(){J&&J.call($),$.title!=P&&-1!=$.title.indexOf("#"+d())&&($.title=P)}}if(O.navigationMode&&(O.navigationMode="compatible"),"complete"==document.readyState)var V=setInterval(function(){t.address&&(y(),clearInterval(V))},50);else m(),t(y);return t(window).bind("popstate",function(){decodeURI(H)!=decodeURI(d())&&(H=d(),f(U))}).bind("unload",function(){N.removeEventListener?N.removeEventListener(x,h,U):N.detachEvent&&N.detachEvent("on"+x,h)}),{bind:function(){return s.apply(this,i(arguments))},unbind:function(){return function(){return t().unbind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address}.apply(this,i(arguments))},init:function(){return s.apply(this,["init"].concat(i(arguments)))},change:function(){return s.apply(this,[k].concat(i(arguments)))},internalChange:function(){return s.apply(this,[E].concat(i(arguments)))},externalChange:function(){return s.apply(this,[S].concat(i(arguments)))},baseURL:function(){var t=L.href;return-1!=t.indexOf("#")&&(t=t.substr(0,t.indexOf("#"))),/\/$/.test(t)&&(t=t.substr(0,t.length-1)),t},autoUpdate:function(t){return t!==e?(R.autoUpdate=t,this):R.autoUpdate},history:function(t){return t!==e?(R.history=t,this):R.history},state:function(t){if(t!==e){R.state=t;var r=c();return R.state!==e&&(O.pushState?"/#/"==r.substr(0,3)&&L.replace(R.state.replace(/^\/$/,"")+r.substr(2)):"/"!=r&&r.replace(/^\/#/,"")!=u()&&C(function(){L.replace(R.state.replace(/^\/$/,"")+"/#"+r)},1)),this}return R.state},strict:function(t){return t!==e?(R.strict=t,this):R.strict},tracker:function(t){return t!==e?(R.tracker=t,this):R.tracker},wrap:function(t){return t!==e?(R.wrap=t,this):R.wrap},update:function(){return G=I,this.value(H),G=U,this},title:function(t){return t!==e?(C(function(){P=$.title=t,Q&&W&&W.contentWindow&&W.contentWindow.document&&(W.contentWindow.document.title=t,Q=U)},50),this):$.title},value:function(t){if(t!==e){if("/"==(t=l(t))&&(t=""),H==t&&!G)return;if(H=t,R.autoUpdate||G){if(f(I))return this;o()?O[R.history?"pushState":"replaceState"]({},"",R.state.replace(/\/$/,"")+(""===H?"/":H)):(D=I,j?R.history?L.hash="#"+H:L.replace("#"+H):H!=d()&&(R.history?L.hash="#"+H:L.replace("#"+H)),q&&!_&&R.history&&C(v,50),j?C(function(){D=U},1):D=U)}return this}return l(H)},path:function(t){if(t!==e){var r=this.queryString(),n=this.hash();return this.value(t+(r?"?"+r:"")+(n?"#"+n:"")),this}return l(H).split("#")[0].split("?")[0]},pathNames:function(){var t=this.path(),e=t.replace(M,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||e.splice(0,1),"/"==t.substr(t.length-1,1)&&e.splice(e.length-1,1),e},queryString:function(t){if(t!==e){var r=this.hash();return this.value(this.path()+(t?"?"+t:"")+(r?"#"+r:"")),this}return(t=H.split("?")).slice(1,t.length).join("?").split("#")[0]},parameter:function(r,n,a){var i,s;if(n!==e){var o=this.parameterNames();for(s=[],n=n===e||n===w?"":n.toString(),i=0;i<o.length;i++){var c=o[i],u=this.parameter(c);"string"==typeof u&&(u=[u]),c==r&&(u=n===w||""===n?[]:a?u.concat([n]):[n]);for(var d=0;d<u.length;d++)s.push(c+"="+u[d])}return-1==t.inArray(r,o)&&n!==w&&""!==n&&s.push(r+"="+n),this.queryString(s.join("&")),this}if(n=this.queryString()){for(a=[],s=n.split("&"),i=0;i<s.length;i++)(n=s[i].split("="))[0]==r&&a.push(n.slice(1).join("="));if(0!==a.length)return 1!=a.length?a:a[0]}},parameterNames:function(){var e=this.queryString(),r=[];if(e&&-1!=e.indexOf("=")){e=e.split("&");for(var n=0;n<e.length;n++){var a=e[n].split("=")[0];-1==t.inArray(a,r)&&r.push(a)}}return r},hash:function(t){return t!==e?(this.value(H.split("#")[0]+(t?"#"+t:"")),this):(t=H.split("#")).slice(1,t.length).join("#")}}}(),t.fn.address=function(e){return this.data("address")||this.on("click",function(r){if(r.shiftKey||r.ctrlKey||r.metaKey||2==r.which)return!0;var n=r.currentTarget;t(n).is("a")&&(r.preventDefault(),r=e?e.call(n):/address:/.test(t(n).attr("rel"))?t(n).attr("rel").split("address:")[1].split(" ")[0]:void 0===t.address.state()||/^\/?$/.test(t.address.state())?t(n).attr("href").replace(/^(#\!?|\.)/,""):t(n).attr("href").replace(new RegExp("^(.*"+t.address.state()+"|\\.)"),""),t.address.value(r))}).on("submit",function(r){var n=r.currentTarget;t(n).is("form")&&(r.preventDefault(),r=t(n).attr("action"),n=e?e.call(n):(-1!=r.indexOf("?")?r.replace(/&$/,""):r+"?")+t(n).serialize(),t.address.value(n))}).data("address",!0),this}}(jQuery);